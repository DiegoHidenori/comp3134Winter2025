basename($path) prevents ../../ attacks.

file_exists() checks if folder exists before scanning.